class Solution {
    public int maxSumDivThree(int[] nums) {

        int sum = 0;

        // Lists for numbers with mod 1 and mod 2
        ArrayList<Integer> mod1 = new ArrayList<>();
        ArrayList<Integer> mod2 = new ArrayList<>();

        for (int n : nums) {
            sum += n;
            if (n % 3 == 1) mod1.add(n);
            else if (n % 3 == 2) mod2.add(n);
        }

        // Sort lists for smallest removals
        mod1.sort((a, b) -> a - b);
        mod2.sort((a, b) -> a - b);

        // If already divisible by 3
        if (sum % 3 == 0) return sum;

        int rem = sum % 3;

        if (rem == 1) {
            int remove1 = mod1.size() > 0 ? mod1.get(0) : Integer.MAX_VALUE;
            int remove2 = (mod2.size() > 1) ? mod2.get(0) + mod2.get(1) : Integer.MAX_VALUE;
            sum -= Math.min(remove1, remove2);
        } else { // rem == 2
            int remove1 = mod2.size() > 0 ? mod2.get(0) : Integer.MAX_VALUE;
            int remove2 = (mod1.size() > 1) ? mod1.get(0) + mod1.get(1) : Integer.MAX_VALUE;
            sum -= Math.min(remove1, remove2);
        }

        return sum;
    }
}
